 
>>> PBS_NODEFILE content:
sophia-gpu-07.lab.alcf.anl.gov
1n*1t
Wed Jul 23 03:55:10 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.127.05             Driver Version: 550.127.05     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-40GB          Off |   00000000:87:00.0 Off |                    0 |
| N/A   27C    P0             51W /  400W |       1MiB /  40960MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-40GB          Off |   00000000:90:00.0 Off |                    0 |
| N/A   26C    P0             49W /  400W |       1MiB /  40960MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2024 NVIDIA Corporation
Built on Thu_Mar_28_02:18:24_PDT_2024
Cuda compilation tools, release 12.4, V12.4.131
Build cuda_12.4.r12.4/compiler.34097967_0
Start time: 2025-07-23 03:55:11
Python 3.9.18
Python path: /lus/eagle/projects/fthmc/software/ml/bin/python
PYTHONPATH: /eagle/fthmc/run
You are using a CUDA device ('NVIDIA A100-SXM4-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/2
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 2 processes
----------------------------------------------------------------------------------------------------

============================================================
>>> CUDA device count: 2
PyTorch version: 2.5.0+cu124
CUDA available: True
>>> Arguments:
Lattice size: 64x64
Minimum beta: 3.5
Maximum beta: 3.5
Beta gap: 0.5
Number of epochs: 32
Batch size: 32
Number of subsets: 8
Number of workers: 0
Model tag: simple
Save tag: simple_test
Random seed: 2008
Identity initialization: True
Check Jacobian: False
Continue training: False
============================================================
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/2
Trying to use torch.compile for optimized computation...
Successfully initialized torch.compile
>>> Training from scratch
Loaded data shape: torch.Size([4096, 2, 64, 64])
Training data shape: torch.Size([3276, 2, 64, 64])
Testing data shape: torch.Size([820, 2, 64, 64])

>>> Training the model at beta =  3.5

>>> Training the model at beta = 3.5

Training epochs:   0%|          | 0/32 [00:00<?, ?it/s]Training epochs:   0%|          | 0/32 [00:00<?, ?it/s]

Epoch 1/32:   0%|          | 0/52 [00:00<?, ?it/s][AEpoch 1/32:   0%|          | 0/52 [00:00<?, ?it/s][AEpoch 1/32:   0%|          | 0/52 [02:01<?, ?it/s]
Training epochs:   0%|          | 0/32 [02:01<?, ?it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/cpp_builder.py", line 331, in _run_compile_cmd
[rank0]:     status = subprocess.check_output(args=cmd, cwd=cwd, stderr=subprocess.STDOUT)
[rank0]:   File "/usr/lib64/python3.9/subprocess.py", line 424, in check_output
[rank0]:     return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
[rank0]:   File "/usr/lib64/python3.9/subprocess.py", line 528, in run
[rank0]:     raise CalledProcessError(retcode, process.args,
[rank0]: subprocess.CalledProcessError: Command '['g++', '/var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp', '-D', 'TORCH_INDUCTOR_CPP_WRAPPER', '-D', 'C10_USING_CUSTOM_GENERATED_MACROS', '-D', 'CPU_CAPABILITY_AVX2', '-shared', '-fPIC', '-O3', '-DNDEBUG', '-ffast-math', '-fno-finite-math-only', '-fno-unsafe-math-optimizations', '-ffp-contract=off', '-march=native', '-Wall', '-std=c++17', '-Wno-unused-variable', '-Wno-unknown-pragmas', '-fopenmp', '-I/usr/include/python3.9', '-I/usr/include/python3.9', '-I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include', '-I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/torch/csrc/api/include', '-I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/TH', '-I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/THC', '-I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include', '-I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/torch/csrc/api/include', '-I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/TH', '-I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/THC', '-mavx2', '-mfma', '-mf16c', '-D_GLIBCXX_USE_CXX11_ABI=0', '-ltorch', '-ltorch_cpu', '-ltorch_python', '-lc10', '-lgomp', '-L/usr/lib64', '-L/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/lib', '-L/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/lib', '-L/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/lib', '-o', '/var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.so']' returned non-zero exit status 1.

[rank0]: The above exception was the direct cause of the following exception:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/output_graph.py", line 1446, in _call_user_compiler
[rank0]:     compiled_fn = compiler_fn(gm, self.example_inputs())
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/repro/after_dynamo.py", line 129, in __call__
[rank0]:     compiled_gm = compiler_fn(gm, example_inputs)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/__init__.py", line 2235, in __call__
[rank0]:     return compile_fx(model_, inputs_, config_patches=self.config)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/compile_fx.py", line 1521, in compile_fx
[rank0]:     return aot_autograd(
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/backends/common.py", line 72, in __call__
[rank0]:     cg = aot_module_simplified(gm, example_inputs, **self.kwargs)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_functorch/aot_autograd.py", line 1071, in aot_module_simplified
[rank0]:     compiled_fn = dispatch_and_compile()
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_functorch/aot_autograd.py", line 1056, in dispatch_and_compile
[rank0]:     compiled_fn, _ = create_aot_dispatcher_function(
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_functorch/aot_autograd.py", line 522, in create_aot_dispatcher_function
[rank0]:     return _create_aot_dispatcher_function(
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_functorch/aot_autograd.py", line 759, in _create_aot_dispatcher_function
[rank0]:     compiled_fn, fw_metadata = compiler_fn(
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_functorch/_aot_autograd/jit_compile_runtime_wrappers.py", line 586, in aot_dispatch_autograd
[rank0]:     compiled_fw_func = aot_config.fw_compiler(fw_module, adjusted_flat_args)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/compile_fx.py", line 1350, in fw_compiler_base
[rank0]:     return _fw_compiler_base(model, example_inputs, is_inference)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/compile_fx.py", line 1421, in _fw_compiler_base
[rank0]:     return inner_compile(
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/compile_fx.py", line 475, in compile_fx_inner
[rank0]:     return wrap_compiler_debug(_compile_fx_inner, compiler_name="inductor")(
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/repro/after_aot.py", line 85, in debug_wrapper
[rank0]:     inner_compiled_fn = compiler_fn(gm, example_inputs)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/compile_fx.py", line 661, in _compile_fx_inner
[rank0]:     compiled_graph = FxGraphCache.load(
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/codecache.py", line 1334, in load
[rank0]:     compiled_graph = compile_fx_fn(
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/compile_fx.py", line 570, in codegen_and_compile
[rank0]:     compiled_graph = fx_codegen_and_compile(gm, example_inputs, **fx_kwargs)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/compile_fx.py", line 878, in fx_codegen_and_compile
[rank0]:     compiled_fn = graph.compile_to_fn()
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/graph.py", line 1913, in compile_to_fn
[rank0]:     return self.compile_to_module().call
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/graph.py", line 1839, in compile_to_module
[rank0]:     return self._compile_to_module()
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/graph.py", line 1867, in _compile_to_module
[rank0]:     mod = PyCodeCache.load_by_key_path(
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/codecache.py", line 2876, in load_by_key_path
[rank0]:     mod = _reload_python_module(key, path)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/runtime/compile_tasks.py", line 45, in _reload_python_module
[rank0]:     exec(code, mod.__dict__, mod.__dict__)
[rank0]:   File "/var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/gu/cgumatwqwhm56opsegkmoqecknnu3cyksuru4nolpk4hdvmahgfa.py", line 498, in <module>
[rank0]:     async_compile.wait(globals())
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/async_compile.py", line 276, in wait
[rank0]:     scope[key] = result.result()
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/codecache.py", line 3353, in result
[rank0]:     return self.result_fn()
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/codecache.py", line 2377, in future
[rank0]:     result = get_result()
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/codecache.py", line 2177, in load_fn
[rank0]:     future.result()
[rank0]:   File "/usr/lib64/python3.9/concurrent/futures/_base.py", line 446, in result
[rank0]:     return self.__get_result()
[rank0]:   File "/usr/lib64/python3.9/concurrent/futures/_base.py", line 391, in __get_result
[rank0]:     raise self._exception
[rank0]:   File "/usr/lib64/python3.9/concurrent/futures/thread.py", line 58, in run
[rank0]:     result = self.fn(*self.args, **self.kwargs)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/codecache.py", line 2218, in _worker_compile_cpp
[rank0]:     cpp_builder.build()
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/cpp_builder.py", line 1508, in build
[rank0]:     status = run_compile_cmd(build_cmd, cwd=_build_tmp_dir)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/cpp_builder.py", line 352, in run_compile_cmd
[rank0]:     return _run_compile_cmd(cmd_line, cwd)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/cpp_builder.py", line 346, in _run_compile_cmd
[rank0]:     raise exc.CppCompileError(cmd, output) from e
[rank0]: torch._inductor.exc.CppCompileError: C++ compile error

[rank0]: Command:
[rank0]: g++ /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp -D TORCH_INDUCTOR_CPP_WRAPPER -D C10_USING_CUSTOM_GENERATED_MACROS -D CPU_CAPABILITY_AVX2 -shared -fPIC -O3 -DNDEBUG -ffast-math -fno-finite-math-only -fno-unsafe-math-optimizations -ffp-contract=off -march=native -Wall -std=c++17 -Wno-unused-variable -Wno-unknown-pragmas -fopenmp -I/usr/include/python3.9 -I/usr/include/python3.9 -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/torch/csrc/api/include -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/TH -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/THC -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/torch/csrc/api/include -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/TH -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/THC -mavx2 -mfma -mf16c -D_GLIBCXX_USE_CXX11_ABI=0 -ltorch -ltorch_cpu -ltorch_python -lc10 -lgomp -L/usr/lib64 -L/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/lib -L/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/lib -L/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/lib -o /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.so

[rank0]: Output:
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In lambda function:
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:61:61: error: ‘struct at::vec::CPU_CAPABILITY::Vectorized<bool>’ has no member named ‘cast’
[rank0]:    61 |                                 auto tmp15 = tmp12.template cast<float,1>();
[rank0]:       |                                                             ^~~~
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:61:66: error: expected primary-expression before ‘float’
[rank0]:    61 |                                 auto tmp15 = tmp12.template cast<float,1>();
[rank0]:       |                                                                  ^~~~~
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In lambda function:
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:69:44: warning: self-comparison always evaluates to true [-Wtautological-compare]
[rank0]:    69 |                         auto tmp19 = tmp18 == tmp18;
[rank0]:       |                                      ~~~~~ ^~ ~~~~~
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In function ‘void kernel(bool*, bool*, int64_t, int64_t)’:
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:99:40: warning: self-comparison always evaluates to true [-Wtautological-compare]
[rank0]:    99 |                     auto tmp42 = tmp41 == tmp41;
[rank0]:       |                                  ~~~~~ ^~ ~~~~~
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In lambda function:
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:146:44: warning: self-comparison always evaluates to true [-Wtautological-compare]
[rank0]:   146 |                         auto tmp12 = tmp11 == tmp11;
[rank0]:       |                                      ~~~~~ ^~ ~~~~~
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In function ‘void kernel(bool*, bool*, int64_t, int64_t)’:
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:171:40: warning: self-comparison always evaluates to true [-Wtautological-compare]
[rank0]:   171 |                     auto tmp30 = tmp29 == tmp29;
[rank0]:       |                                  ~~~~~ ^~ ~~~~~


[rank0]: The above exception was the direct cause of the following exception:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/lus/eagle/projects/fthmc/run/fthmc_2d_u1/ft_train_test/train.py", line 120, in <module>
[rank0]:     nn_ft.train(train_data, test_data, train_beta, n_epochs=args.n_epochs, batch_size=args.batch_size)
[rank0]:   File "/eagle/fthmc/run/fthmc_2d_u1/utils/field_trans.py", line 554, in train
[rank0]:     loss = self.train_step(batch)
[rank0]:   File "/eagle/fthmc/run/fthmc_2d_u1/utils/field_trans.py", line 474, in train_step
[rank0]:     loss = self.loss_fn(theta_ori)
[rank0]:   File "/eagle/fthmc/run/fthmc_2d_u1/utils/field_trans.py", line 445, in loss_fn
[rank0]:     theta_new = self.inverse(theta_ori)
[rank0]:   File "/eagle/fthmc/run/fthmc_2d_u1/utils/field_trans.py", line 260, in inverse
[rank0]:     inv_phase = -self.ft_phase_compiled(theta_iter, index)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/eval_frame.py", line 465, in _fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/eagle/fthmc/run/fthmc_2d_u1/utils/field_trans.py", line 178, in ft_phase
[rank0]:     K0, K1 = self.compute_K0_K1(theta, index, plaq, rect) # [batch_size, 4, L, L], [batch_size, 8, L, L]
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 1269, in __call__
[rank0]:     return self._torchdynamo_orig_callable(
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 1064, in __call__
[rank0]:     result = self._inner_convert(
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 526, in __call__
[rank0]:     return _compile(
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 924, in _compile
[rank0]:     guarded_code = compile_inner(code, one_graph, hooks, transform)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 666, in compile_inner
[rank0]:     return _compile_inner(code, one_graph, hooks, transform)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_utils_internal.py", line 87, in wrapper_function
[rank0]:     return function(*args, **kwargs)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 699, in _compile_inner
[rank0]:     out_code = transform_code_object(code, transform)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/bytecode_transformation.py", line 1322, in transform_code_object
[rank0]:     transformations(instructions, code_options)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 219, in _fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 634, in transform
[rank0]:     tracer.run()
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/symbolic_convert.py", line 2796, in run
[rank0]:     super().run()
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/symbolic_convert.py", line 983, in run
[rank0]:     while self.step():
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/symbolic_convert.py", line 895, in step
[rank0]:     self.dispatch_table[inst.opcode](self, inst)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/symbolic_convert.py", line 580, in wrapper
[rank0]:     return handle_graph_break(self, inst, speculation.reason)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/symbolic_convert.py", line 649, in handle_graph_break
[rank0]:     self.output.compile_subgraph(self, reason=reason)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/output_graph.py", line 1142, in compile_subgraph
[rank0]:     self.compile_and_call_fx_graph(tx, pass2.graph_output_vars(), root)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/output_graph.py", line 1369, in compile_and_call_fx_graph
[rank0]:     compiled_fn = self.call_user_compiler(gm)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/output_graph.py", line 1416, in call_user_compiler
[rank0]:     return self._call_user_compiler(gm)
[rank0]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/output_graph.py", line 1465, in _call_user_compiler
[rank0]:     raise BackendCompilerFailed(self.compiler_fn, e) from e
[rank0]: torch._dynamo.exc.BackendCompilerFailed: backend='inductor' raised:
[rank0]: CppCompileError: C++ compile error

[rank0]: Command:
[rank0]: g++ /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp -D TORCH_INDUCTOR_CPP_WRAPPER -D C10_USING_CUSTOM_GENERATED_MACROS -D CPU_CAPABILITY_AVX2 -shared -fPIC -O3 -DNDEBUG -ffast-math -fno-finite-math-only -fno-unsafe-math-optimizations -ffp-contract=off -march=native -Wall -std=c++17 -Wno-unused-variable -Wno-unknown-pragmas -fopenmp -I/usr/include/python3.9 -I/usr/include/python3.9 -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/torch/csrc/api/include -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/TH -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/THC -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/torch/csrc/api/include -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/TH -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/THC -mavx2 -mfma -mf16c -D_GLIBCXX_USE_CXX11_ABI=0 -ltorch -ltorch_cpu -ltorch_python -lc10 -lgomp -L/usr/lib64 -L/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/lib -L/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/lib -L/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/lib -o /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.so

[rank0]: Output:
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In lambda function:
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:61:61: error: ‘struct at::vec::CPU_CAPABILITY::Vectorized<bool>’ has no member named ‘cast’
[rank0]:    61 |                                 auto tmp15 = tmp12.template cast<float,1>();
[rank0]:       |                                                             ^~~~
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:61:66: error: expected primary-expression before ‘float’
[rank0]:    61 |                                 auto tmp15 = tmp12.template cast<float,1>();
[rank0]:       |                                                                  ^~~~~
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In lambda function:
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:69:44: warning: self-comparison always evaluates to true [-Wtautological-compare]
[rank0]:    69 |                         auto tmp19 = tmp18 == tmp18;
[rank0]:       |                                      ~~~~~ ^~ ~~~~~
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In function ‘void kernel(bool*, bool*, int64_t, int64_t)’:
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:99:40: warning: self-comparison always evaluates to true [-Wtautological-compare]
[rank0]:    99 |                     auto tmp42 = tmp41 == tmp41;
[rank0]:       |                                  ~~~~~ ^~ ~~~~~
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In lambda function:
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:146:44: warning: self-comparison always evaluates to true [-Wtautological-compare]
[rank0]:   146 |                         auto tmp12 = tmp11 == tmp11;
[rank0]:       |                                      ~~~~~ ^~ ~~~~~
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In function ‘void kernel(bool*, bool*, int64_t, int64_t)’:
[rank0]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:171:40: warning: self-comparison always evaluates to true [-Wtautological-compare]
[rank0]:   171 |                     auto tmp30 = tmp29 == tmp29;
[rank0]:       |                                  ~~~~~ ^~ ~~~~~


[rank0]: Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information


[rank0]: You can suppress this exception and fall back to eager by setting:
[rank0]:     import torch._dynamo
[rank0]:     torch._dynamo.config.suppress_errors = True

Epoch 1/32:   0%|          | 0/52 [02:03<?, ?it/s]
Training epochs:   0%|          | 0/32 [02:03<?, ?it/s]
[rank1]: Traceback (most recent call last):
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/cpp_builder.py", line 331, in _run_compile_cmd
[rank1]:     status = subprocess.check_output(args=cmd, cwd=cwd, stderr=subprocess.STDOUT)
[rank1]:   File "/usr/lib64/python3.9/subprocess.py", line 424, in check_output
[rank1]:     return run(*popenargs, stdout=PIPE, timeout=timeout, check=True,
[rank1]:   File "/usr/lib64/python3.9/subprocess.py", line 528, in run
[rank1]:     raise CalledProcessError(retcode, process.args,
[rank1]: subprocess.CalledProcessError: Command '['g++', '/var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp', '-D', 'TORCH_INDUCTOR_CPP_WRAPPER', '-D', 'C10_USING_CUSTOM_GENERATED_MACROS', '-D', 'CPU_CAPABILITY_AVX2', '-shared', '-fPIC', '-O3', '-DNDEBUG', '-ffast-math', '-fno-finite-math-only', '-fno-unsafe-math-optimizations', '-ffp-contract=off', '-march=native', '-Wall', '-std=c++17', '-Wno-unused-variable', '-Wno-unknown-pragmas', '-fopenmp', '-I/usr/include/python3.9', '-I/usr/include/python3.9', '-I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include', '-I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/torch/csrc/api/include', '-I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/TH', '-I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/THC', '-I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include', '-I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/torch/csrc/api/include', '-I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/TH', '-I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/THC', '-mavx2', '-mfma', '-mf16c', '-D_GLIBCXX_USE_CXX11_ABI=0', '-ltorch', '-ltorch_cpu', '-ltorch_python', '-lc10', '-lgomp', '-L/usr/lib64', '-L/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/lib', '-L/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/lib', '-L/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/lib', '-o', '/var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.so']' returned non-zero exit status 1.

[rank1]: The above exception was the direct cause of the following exception:

[rank1]: Traceback (most recent call last):
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/output_graph.py", line 1446, in _call_user_compiler
[rank1]:     compiled_fn = compiler_fn(gm, self.example_inputs())
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/repro/after_dynamo.py", line 129, in __call__
[rank1]:     compiled_gm = compiler_fn(gm, example_inputs)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/__init__.py", line 2235, in __call__
[rank1]:     return compile_fx(model_, inputs_, config_patches=self.config)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/compile_fx.py", line 1521, in compile_fx
[rank1]:     return aot_autograd(
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/backends/common.py", line 72, in __call__
[rank1]:     cg = aot_module_simplified(gm, example_inputs, **self.kwargs)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_functorch/aot_autograd.py", line 1071, in aot_module_simplified
[rank1]:     compiled_fn = dispatch_and_compile()
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_functorch/aot_autograd.py", line 1056, in dispatch_and_compile
[rank1]:     compiled_fn, _ = create_aot_dispatcher_function(
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_functorch/aot_autograd.py", line 522, in create_aot_dispatcher_function
[rank1]:     return _create_aot_dispatcher_function(
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_functorch/aot_autograd.py", line 759, in _create_aot_dispatcher_function
[rank1]:     compiled_fn, fw_metadata = compiler_fn(
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_functorch/_aot_autograd/jit_compile_runtime_wrappers.py", line 586, in aot_dispatch_autograd
[rank1]:     compiled_fw_func = aot_config.fw_compiler(fw_module, adjusted_flat_args)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/compile_fx.py", line 1350, in fw_compiler_base
[rank1]:     return _fw_compiler_base(model, example_inputs, is_inference)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/compile_fx.py", line 1421, in _fw_compiler_base
[rank1]:     return inner_compile(
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/compile_fx.py", line 475, in compile_fx_inner
[rank1]:     return wrap_compiler_debug(_compile_fx_inner, compiler_name="inductor")(
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/repro/after_aot.py", line 85, in debug_wrapper
[rank1]:     inner_compiled_fn = compiler_fn(gm, example_inputs)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/compile_fx.py", line 661, in _compile_fx_inner
[rank1]:     compiled_graph = FxGraphCache.load(
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/codecache.py", line 1334, in load
[rank1]:     compiled_graph = compile_fx_fn(
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/compile_fx.py", line 570, in codegen_and_compile
[rank1]:     compiled_graph = fx_codegen_and_compile(gm, example_inputs, **fx_kwargs)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/compile_fx.py", line 878, in fx_codegen_and_compile
[rank1]:     compiled_fn = graph.compile_to_fn()
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/graph.py", line 1913, in compile_to_fn
[rank1]:     return self.compile_to_module().call
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/graph.py", line 1839, in compile_to_module
[rank1]:     return self._compile_to_module()
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/graph.py", line 1867, in _compile_to_module
[rank1]:     mod = PyCodeCache.load_by_key_path(
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/codecache.py", line 2876, in load_by_key_path
[rank1]:     mod = _reload_python_module(key, path)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/runtime/compile_tasks.py", line 45, in _reload_python_module
[rank1]:     exec(code, mod.__dict__, mod.__dict__)
[rank1]:   File "/var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/ka/ckanpqtbpuf3bhervyphsqzdvcpfkv4tces2eiqsziraeaxg5khz.py", line 498, in <module>
[rank1]:     async_compile.wait(globals())
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/async_compile.py", line 276, in wait
[rank1]:     scope[key] = result.result()
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/codecache.py", line 3353, in result
[rank1]:     return self.result_fn()
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/codecache.py", line 2377, in future
[rank1]:     result = get_result()
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/codecache.py", line 2177, in load_fn
[rank1]:     future.result()
[rank1]:   File "/usr/lib64/python3.9/concurrent/futures/_base.py", line 446, in result
[rank1]:     return self.__get_result()
[rank1]:   File "/usr/lib64/python3.9/concurrent/futures/_base.py", line 391, in __get_result
[rank1]:     raise self._exception
[rank1]:   File "/usr/lib64/python3.9/concurrent/futures/thread.py", line 58, in run
[rank1]:     result = self.fn(*self.args, **self.kwargs)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/codecache.py", line 2218, in _worker_compile_cpp
[rank1]:     cpp_builder.build()
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/cpp_builder.py", line 1508, in build
[rank1]:     status = run_compile_cmd(build_cmd, cwd=_build_tmp_dir)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/cpp_builder.py", line 352, in run_compile_cmd
[rank1]:     return _run_compile_cmd(cmd_line, cwd)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_inductor/cpp_builder.py", line 346, in _run_compile_cmd
[rank1]:     raise exc.CppCompileError(cmd, output) from e
[rank1]: torch._inductor.exc.CppCompileError: C++ compile error

[rank1]: Command:
[rank1]: g++ /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp -D TORCH_INDUCTOR_CPP_WRAPPER -D C10_USING_CUSTOM_GENERATED_MACROS -D CPU_CAPABILITY_AVX2 -shared -fPIC -O3 -DNDEBUG -ffast-math -fno-finite-math-only -fno-unsafe-math-optimizations -ffp-contract=off -march=native -Wall -std=c++17 -Wno-unused-variable -Wno-unknown-pragmas -fopenmp -I/usr/include/python3.9 -I/usr/include/python3.9 -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/torch/csrc/api/include -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/TH -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/THC -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/torch/csrc/api/include -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/TH -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/THC -mavx2 -mfma -mf16c -D_GLIBCXX_USE_CXX11_ABI=0 -ltorch -ltorch_cpu -ltorch_python -lc10 -lgomp -L/usr/lib64 -L/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/lib -L/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/lib -L/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/lib -o /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.so

[rank1]: Output:
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In lambda function:
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:61:61: error: ‘struct at::vec::CPU_CAPABILITY::Vectorized<bool>’ has no member named ‘cast’
[rank1]:    61 |                                 auto tmp15 = tmp12.template cast<float,1>();
[rank1]:       |                                                             ^~~~
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:61:66: error: expected primary-expression before ‘float’
[rank1]:    61 |                                 auto tmp15 = tmp12.template cast<float,1>();
[rank1]:       |                                                                  ^~~~~
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In lambda function:
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:69:44: warning: self-comparison always evaluates to true [-Wtautological-compare]
[rank1]:    69 |                         auto tmp19 = tmp18 == tmp18;
[rank1]:       |                                      ~~~~~ ^~ ~~~~~
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In function ‘void kernel(bool*, bool*, int64_t, int64_t)’:
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:99:40: warning: self-comparison always evaluates to true [-Wtautological-compare]
[rank1]:    99 |                     auto tmp42 = tmp41 == tmp41;
[rank1]:       |                                  ~~~~~ ^~ ~~~~~
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In lambda function:
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:146:44: warning: self-comparison always evaluates to true [-Wtautological-compare]
[rank1]:   146 |                         auto tmp12 = tmp11 == tmp11;
[rank1]:       |                                      ~~~~~ ^~ ~~~~~
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In function ‘void kernel(bool*, bool*, int64_t, int64_t)’:
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:171:40: warning: self-comparison always evaluates to true [-Wtautological-compare]
[rank1]:   171 |                     auto tmp30 = tmp29 == tmp29;
[rank1]:       |                                  ~~~~~ ^~ ~~~~~


[rank1]: The above exception was the direct cause of the following exception:

[rank1]: Traceback (most recent call last):
[rank1]:   File "/lus/eagle/projects/fthmc/run/fthmc_2d_u1/ft_train_test/train.py", line 120, in <module>
[rank1]:     nn_ft.train(train_data, test_data, train_beta, n_epochs=args.n_epochs, batch_size=args.batch_size)
[rank1]:   File "/eagle/fthmc/run/fthmc_2d_u1/utils/field_trans.py", line 554, in train
[rank1]:     loss = self.train_step(batch)
[rank1]:   File "/eagle/fthmc/run/fthmc_2d_u1/utils/field_trans.py", line 474, in train_step
[rank1]:     loss = self.loss_fn(theta_ori)
[rank1]:   File "/eagle/fthmc/run/fthmc_2d_u1/utils/field_trans.py", line 445, in loss_fn
[rank1]:     theta_new = self.inverse(theta_ori)
[rank1]:   File "/eagle/fthmc/run/fthmc_2d_u1/utils/field_trans.py", line 260, in inverse
[rank1]:     inv_phase = -self.ft_phase_compiled(theta_iter, index)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/eval_frame.py", line 465, in _fn
[rank1]:     return fn(*args, **kwargs)
[rank1]:   File "/eagle/fthmc/run/fthmc_2d_u1/utils/field_trans.py", line 178, in ft_phase
[rank1]:     K0, K1 = self.compute_K0_K1(theta, index, plaq, rect) # [batch_size, 4, L, L], [batch_size, 8, L, L]
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 1269, in __call__
[rank1]:     return self._torchdynamo_orig_callable(
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 1064, in __call__
[rank1]:     result = self._inner_convert(
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 526, in __call__
[rank1]:     return _compile(
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 924, in _compile
[rank1]:     guarded_code = compile_inner(code, one_graph, hooks, transform)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 666, in compile_inner
[rank1]:     return _compile_inner(code, one_graph, hooks, transform)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_utils_internal.py", line 87, in wrapper_function
[rank1]:     return function(*args, **kwargs)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 699, in _compile_inner
[rank1]:     out_code = transform_code_object(code, transform)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/bytecode_transformation.py", line 1322, in transform_code_object
[rank1]:     transformations(instructions, code_options)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 219, in _fn
[rank1]:     return fn(*args, **kwargs)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/convert_frame.py", line 634, in transform
[rank1]:     tracer.run()
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/symbolic_convert.py", line 2796, in run
[rank1]:     super().run()
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/symbolic_convert.py", line 983, in run
[rank1]:     while self.step():
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/symbolic_convert.py", line 895, in step
[rank1]:     self.dispatch_table[inst.opcode](self, inst)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/symbolic_convert.py", line 580, in wrapper
[rank1]:     return handle_graph_break(self, inst, speculation.reason)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/symbolic_convert.py", line 649, in handle_graph_break
[rank1]:     self.output.compile_subgraph(self, reason=reason)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/output_graph.py", line 1142, in compile_subgraph
[rank1]:     self.compile_and_call_fx_graph(tx, pass2.graph_output_vars(), root)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/output_graph.py", line 1369, in compile_and_call_fx_graph
[rank1]:     compiled_fn = self.call_user_compiler(gm)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/output_graph.py", line 1416, in call_user_compiler
[rank1]:     return self._call_user_compiler(gm)
[rank1]:   File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/_dynamo/output_graph.py", line 1465, in _call_user_compiler
[rank1]:     raise BackendCompilerFailed(self.compiler_fn, e) from e
[rank1]: torch._dynamo.exc.BackendCompilerFailed: backend='inductor' raised:
[rank1]: CppCompileError: C++ compile error

[rank1]: Command:
[rank1]: g++ /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp -D TORCH_INDUCTOR_CPP_WRAPPER -D C10_USING_CUSTOM_GENERATED_MACROS -D CPU_CAPABILITY_AVX2 -shared -fPIC -O3 -DNDEBUG -ffast-math -fno-finite-math-only -fno-unsafe-math-optimizations -ffp-contract=off -march=native -Wall -std=c++17 -Wno-unused-variable -Wno-unknown-pragmas -fopenmp -I/usr/include/python3.9 -I/usr/include/python3.9 -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/torch/csrc/api/include -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/TH -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/THC -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/torch/csrc/api/include -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/TH -I/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/include/THC -mavx2 -mfma -mf16c -D_GLIBCXX_USE_CXX11_ABI=0 -ltorch -ltorch_cpu -ltorch_python -lc10 -lgomp -L/usr/lib64 -L/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/lib -L/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/lib -L/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/lib -o /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.so

[rank1]: Output:
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In lambda function:
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:61:61: error: ‘struct at::vec::CPU_CAPABILITY::Vectorized<bool>’ has no member named ‘cast’
[rank1]:    61 |                                 auto tmp15 = tmp12.template cast<float,1>();
[rank1]:       |                                                             ^~~~
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:61:66: error: expected primary-expression before ‘float’
[rank1]:    61 |                                 auto tmp15 = tmp12.template cast<float,1>();
[rank1]:       |                                                                  ^~~~~
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In lambda function:
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:69:44: warning: self-comparison always evaluates to true [-Wtautological-compare]
[rank1]:    69 |                         auto tmp19 = tmp18 == tmp18;
[rank1]:       |                                      ~~~~~ ^~ ~~~~~
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In function ‘void kernel(bool*, bool*, int64_t, int64_t)’:
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:99:40: warning: self-comparison always evaluates to true [-Wtautological-compare]
[rank1]:    99 |                     auto tmp42 = tmp41 == tmp41;
[rank1]:       |                                  ~~~~~ ^~ ~~~~~
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In lambda function:
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:146:44: warning: self-comparison always evaluates to true [-Wtautological-compare]
[rank1]:   146 |                         auto tmp12 = tmp11 == tmp11;
[rank1]:       |                                      ~~~~~ ^~ ~~~~~
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp: In function ‘void kernel(bool*, bool*, int64_t, int64_t)’:
[rank1]: /var/tmp/pbs.76202.sophia-pbs-01.lab.alcf.anl.gov/torchinductor_jinchen/qk/cqkukpqsbvcmmzcji4bxp4cqb25d6rxchsxw4h2gpjbzwbp2525c.cpp:171:40: warning: self-comparison always evaluates to true [-Wtautological-compare]
[rank1]:   171 |                     auto tmp30 = tmp29 == tmp29;
[rank1]:       |                                  ~~~~~ ^~ ~~~~~


[rank1]: Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information


[rank1]: You can suppress this exception and fall back to eager by setting:
[rank1]:     import torch._dynamo
[rank1]:     torch._dynamo.config.suppress_errors = True

W0723 03:57:28.480246 1024002 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 1024136 closing signal SIGTERM
E0723 03:57:28.835401 1024002 torch/distributed/elastic/multiprocessing/api.py:869] failed (exitcode: 1) local_rank: 0 (pid: 1024135) of binary: /lus/eagle/projects/fthmc/software/ml/bin/python
Traceback (most recent call last):
  File "/lus/eagle/projects/fthmc/software/ml/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
  File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/distributed/run.py", line 919, in main
    run(args)
  File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/distributed/run.py", line 910, in run
    elastic_launch(
  File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/lus/eagle/projects/fthmc/software/ml/lib64/python3.9/site-packages/torch/distributed/launcher/api.py", line 269, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
train.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-07-23_03:57:28
  host      : sophia-gpu-07.lab.alcf.anl.gov
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 1024135)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
End time: 2025-07-23 03:57:29
Total time: 0h 2m 18s
